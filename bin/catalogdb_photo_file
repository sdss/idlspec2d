#!/usr/bin/env python
import sys
import numpy as np
import warnings
warnings.filterwarnings("ignore")
infile = sys.argv[1]
#ra=np.float(sys.argv[1])
#dec=np.float(sys.argv[2])
#from sdssdb.peewee.sdss5db import catalogdb
#print(catalogdb.database.set_profile('operations'))
from sdssdb.peewee.sdss5db.catalogdb import database
database.set_profile('operations')

from sdssdb.peewee.sdss5db.catalogdb import AllWise
wise_best=AllWise.select(AllWise.ra,AllWise.dec,AllWise.w1mpro,AllWise.w2mpro,AllWise.w3mpro,AllWise.w4mpro,AllWise.j_m_2mass,AllWise.h_m_2mass,AllWise.k_m_2mass)
from sdssdb.peewee.sdss5db.catalogdb import Gaia_DR2
gaia_best=Gaia_DR2.select(Gaia_DR2.ra,Gaia_DR2.dec,Gaia_DR2.parallax,Gaia_DR2.pmra,Gaia_DR2.pmdec)
from sdssdb.peewee.sdss5db.catalogdb import GUVCat
guvcat_best=GUVCat.select(GUVCat.ra,GUVCat.dec,GUVCat.fuv_mag,GUVCat.nuv_mag)

ras=[81.809271]*5
decs=[-2.1386296]*5

fp=open(infile)

lines = fp.readlines()
for line in lines :
 ra=line.split()[0]
 dec=line.split()[1]
 try:
  tp=wise_best.where(AllWise.cone_search(ra, dec, 2.0/3600.0))
  if len(tp) > 0:
    w1mpro=float(tp[0].w1mpro)
    w2mpro=float(tp[0].w2mpro)
    w3mpro=float(tp[0].w3mpro)
    w4mpro=float(tp[0].w4mpro)
    try:
      j2mass=float(tp[0].j_m_2mass)
      h2mass=float(tp[0].h_m_2mass)
      k2mass=float(tp[0].k_m_2mass)
    except:
      j2mass=-100.
      h2mass=-100.
      k2mass=-100.
  else:
    w1mpro=-100.
    w2mpro=-100.
    w3mpro=-100.
    w4mpro=-100.
    j2mass=-100.
    h2mass=-100.
    k2mass=-100.
 except:
    w1mpro=-100.
    w2mpro=-100.
    w3mpro=-100.
    w4mpro=-100.
    j2mass=-100.
    h2mass=-100.
    k2mass=-100.
#try:
#  from sdssdb.peewee.sdss5db.catalogdb import TwoMassPSC, Gaia_DR2, GUVCat
#  twomass_best=TwoMassPSC.select(TwoMassPSC.ra,TwoMassPSC.decl,TwoMassPSC.j_m,TwoMassPSC.h_m,TwoMassPSC.k_m)
#  tp=twomass_best.where(TwoMassPSC.cone_search(ra, dec, 2.0/3600.0,dec_col='decl'))
#  if len(tp) > 0:
#    j2mass=float(tp[0].j_m)
#    h2mass=float(tp[0].h_m)
#    k2mass=float(tp[0].k_m)
#  else:
#    j2mass=-100.
#    h2mass=-100.
#    k2mass=-100.
#except:
#    j2mass=-100.
#    h2mass=-100.
#    k2mass=-100.
 try:
  tp=gaia_best.where(Gaia_DR2.cone_search(ra, dec, 2.0/3600.0))
  if len(tp) > 0:
    parallax=float(tp[0].parallax)
    pmra=float(tp[0].pmra)
    pmdec=float(tp[0].pmdec)
  else:
    parallax=-100.
    pmra=-100.
    pmdec=-100.
 except:
    parallax=-100.
    pmra=-100.
    pmdec=-100.
 try:
  tp=guvcat_best.where(GUVCat.cone_search(ra, dec, 2.0/3600.0))
  if len(tp) > 0:
    fuv=float(tp[0].fuv_mag)
    nuv=float(tp[0].nuv_mag)
  else:
    fuv=-100.
    nuv=-100.
 except:
    fuv=-100.
    nuv=-100.    
    
 print(w1mpro,w2mpro,w3mpro,w4mpro,j2mass,h2mass,k2mass,fuv,nuv,parallax,pmra,pmdec)
